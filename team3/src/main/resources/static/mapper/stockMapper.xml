<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.vet.clinic.dao.StockDAO">
<!-- 초기화면 -->
	<!-- CAST(FORMAT(medical_price,'##,###,##0') AS INT) AS medical_price, CAST(FORMAT(medical_buying,'###,##0') AS INT) as medical_buying, -->
	<select id="stockList" resultType="StockDTO">
		SELECT medical_subcate, medical_name,medical_price,medical_buying, medical_company, medical_buyEa
		FROM medicalList
		WHERE medical_category != '진료'
		ORDER BY medical_name
	</select>
	
	<select id="m_company" resultType="String">
		SELECT DISTINCT medical_company
		FROM medicalList
		WHERE medical_company IS NOT NULL
		ORDER BY medical_company
	</select>
	
	<select id="m_subcate" resultType="String">
		SELECT DISTINCT medical_subcate
		FROM medicalList
		WHERE medical_category != '진료'
		ORDER BY medical_subcate
	</select>

<!-- 검색 -->
	<select id="stockSelect" parameterType="HashMap" resultType="HashMap">
		SELECT medical_subcate, medical_name, medical_price, medical_buying, medical_company, medical_buyEa
		FROM medicalList
		WHERE medical_category != '진료'
		<if test="radioValue != '전체보기'">
			AND medical_subcate = #{radioValue }
		</if>
		<if test='medicineName != null and !"".equals(medicineName)'>
			AND medical_name = #{medicineName }
		</if>
		<choose>
			<when test="purchasingOfficeOption != '직접입력'">
				AND medical_company = #{purchasingOfficeOption }
			</when>
			<when test='purchasingOfficeOption == "직접입력" and purchasingOffice != null and !"".equals(purchasingOffice)'>
				AND medical_company = #{purchasingOffice }
			</when>
		</choose>
		ORDER BY medical_name
	</select>

</mapper>